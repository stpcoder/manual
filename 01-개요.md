# 제1장 프로젝트 개요

## 1.1 명칭

본 시스템의 정식 명칭은 "고문서 손상 영역 인식 시스템(Ancient Document Damage Detection System)"이다.

## 1.2 목적

본 시스템은 조선시대 고문서에 존재하는 물리적 손상 부위(구멍, 찢어짐, 결실 등)를 고해상도 스캔 이미지로부터 자동으로 검출하고, 복원에 필요한 보충 용지 절단 레이아웃 및 위치 가이드를 생성하는 것을 목적으로 한다.

## 1.3 배경 및 필요성

문화재 복원 현장에서 고문서의 손상 부위를 보충하는 작업은 다음과 같은 수작업 과정을 필요로 한다.

1. 고해상도 스캔 이미지에서 손상 부위를 개별적으로 식별한다.
2. Adobe Photoshop 등의 이미지 편집 소프트웨어에서 각 손상 부위의 윤곽을 수동으로 트레이싱한다.
3. Adobe Illustrator 등의 벡터 편집 소프트웨어에서 보충 용지 절단을 위한 레이아웃을 수작업으로 배치한다.
4. 절단된 보충 용지 조각을 원본 문서의 해당 위치에 정확히 부착한다.

이 과정에서 단일 문서 1매당 평균 3시간에서 5시간의 작업 시간이 소요되며, 복원 위치 파악은 작업자의 기억에 의존하여 오류가 빈발하는 실정이다.

본 시스템은 상기 수작업 과정의 전체를 자동화하여, 동일 작업을 약 15초 이내에 완료할 수 있도록 한다. 이는 기존 대비 99.9% 이상의 시간 절감에 해당한다.

| 공정 | 기존 수작업 | 본 시스템 |
|------|------------|----------|
| 손상 부위 트레이싱 | Photoshop 개별 선택 (2-3시간) | 자동 검출 (10초) |
| 보충 용지 배치 | Illustrator 수동 배치 (1-2시간) | Bin Packing 자동 배치 (1초) |
| 복원 위치 파악 | 작업자 기억 의존, 오류 빈발 | 번호 기반 가이드 이미지 자동 생성 |
| 총 소요 시간 | 3-5시간 | 약 15초 |

## 1.4 대상 사용자

본 시스템의 주요 대상 사용자는 다음과 같다.

- 문화재 복원 연구원
- 고문서 보존 처리 전문가
- 박물관 및 미술관 보존과학실 소속 인력
- 문화재 관련 학술 연구자

## 1.5 핵심 기능 요약

본 시스템은 다음의 핵심 기능을 제공한다.

### 1.5.1 손상 영역 자동 검출

HSV 및 LAB 색공간 분석, Gaussian Mixture Model(GMM) 기반 Mahalanobis 거리 분류를 통해 이미지 내 손상 부위를 픽셀 단위로 자동 검출한다. 사용자가 다수의 표본 영역을 지정하면 GMM이 색 분포를 학습하여 분류 정밀도를 향상시킨다.

### 1.5.2 레이저 커팅 레이아웃 자동 생성

Skyline Bin Packing 알고리즘을 적용하여 검출된 손상 부위의 형상을 지정 용지 크기(A4, A3, B4 등) 위에 최적 배치한다. 결과물은 레이저 커터 호환 SVG 벡터 파일로 출력된다.

### 1.5.3 복원 가이드 생성

원본 이미지 위에 각 손상 부위의 번호를 오버레이한 가이드 이미지를 생성하여, 커팅 레이아웃의 조각 번호와 원본 문서의 위치를 1:1로 대응시킨다.

### 1.5.4 인터랙티브 편집

GUI 환경에서 검출 결과를 시각적으로 확인하고, 개별 조각의 활성/비활성 토글, 영역 일괄 해제, 재번호 부여, 실측 캘리브레이션 등의 인터랙티브 편집 기능을 제공한다.

### 1.5.5 세션 관리

작업 상태(이미지, 검출 결과, 학습된 모델, 레이아웃 설정)를 JSON 형식으로 저장 및 복원할 수 있어, 중단된 작업을 이어서 수행할 수 있다.

## 1.6 기술 스택

| 구분 | 기술 | 용도 |
|------|------|------|
| GUI 프레임워크 | PyQt6 | 데스크탑 사용자 인터페이스, 시그널/슬롯 이벤트 시스템 |
| 이미지 처리 | OpenCV 4.x | 색공간 변환, 윤곽선 추출, 형태학적 연산 |
| 수치 연산 | NumPy, SciPy | 배열 연산, 통계 분석, 선형대수 |
| 시각화 | Matplotlib, Pillow | 결과 시각화, 이미지 입출력 |
| 벡터 처리 | Shapely, svgpathtools, pyclipper | 폴리곤 연산, SVG 파싱, 충돌 검사 |
| 과학 영상 | scikit-image | 영상 처리 보조 기능 |
| 빌드 | PyInstaller | Windows 실행 파일 생성 |
| 프로그래밍 언어 | Python 3.8 이상 | 전체 시스템 구현 |

## 1.7 지원 이미지 형식

본 시스템은 다음의 이미지 형식을 지원한다.

- TIFF (.tif, .tiff) -- 고해상도 스캔 이미지에 최적화
- PNG (.png)
- JPEG (.jpg, .jpeg)
- BMP (.bmp)

39 메가픽셀(MP) 이상의 고해상도 이미지에 대해 테스트가 완료되었으며, 267MP급 초고해상도 이미지도 청크 처리를 통해 처리 가능하다.

## 1.8 라이선스

본 소프트웨어는 MIT 라이선스 하에 배포된다.
